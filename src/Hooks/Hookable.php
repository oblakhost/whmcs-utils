<?php

/**
 * Hookable class file
 *
 * @package WHMCS Utils
 */

namespace Oblak\WHMCS\Hooks;

use Exception;

/**
 * Provides a hookable interface for WHMCS
 */
abstract class Hookable
{
    /**
     * List of available WHMCS hooks
     *
     * @var array
     */
    protected static array $availableHooks = [
        'AcceptQuote',
        'AddInvoiceLateFee',
        'AddInvoicePayment',
        'AddTransaction',
        'AfterInvoicingGenerateInvoiceItems',
        'CancelAndRefundOrder',
        'InvoiceCancelled',
        'InvoiceChangeGateway',
        'InvoiceCreated',
        'InvoiceCreation',
        'InvoiceCreationPreEmail',
        'InvoicePaid',
        'InvoicePaidPreEmail',
        'InvoicePaymentReminder',
        'InvoiceRefunded',
        'InvoiceSplit',
        'InvoiceUnpaid',
        'LogTransaction',
        'ManualRefund',
        'PreInvoicingGenerateInvoiceItems',
        'QuoteCreated',
        'QuoteStatusChange',
        'UpdateInvoiceTotal',
        'ViewInvoiceDetailsPage',
        'AcceptOrder',
        'AddonFraud',
        'AfterCalculateCartTotals',
        'AfterFraudCheck',
        'AfterShoppingCartCheckout',
        'CancelOrder',
        'CartItemsTax',
        'CartSubdomainValidation',
        'CartTotalAdjustment',
        'DeleteOrder',
        'FraudCheckAwaitingUserInput',
        'FraudCheckFailed',
        'FraudCheckPassed',
        'FraudOrder',
        'OrderAddonPricingOverride',
        'OrderDomainPricingOverride',
        'OrderPaid',
        'OrderProductPricingOverride',
        'OrderProductUpgradeOverride',
        'OverrideOrderNumberGeneration',
        'PendingOrder',
        'PreCalculateCartTotals',
        'PreFraudCheck',
        'PreShoppingCartCheckout',
        'RunFraudCheck',
        'ShoppingCartCheckoutCompletePage',
        'ShoppingCartValidateCheckout',
        'ShoppingCartValidateDomain',
        'ShoppingCartValidateDomainsConfig',
        'ShoppingCartValidateProductUpdate',
        'CancellationRequest',
        'PreServiceEdit',
        'ServiceDelete',
        'ServiceEdit',
        'ServiceRecurringCompleted',
        'AfterModuleChangePackage',
        'AfterModuleChangePackageFailed',
        'AfterModuleChangePassword',
        'AfterModuleChangePasswordFailed',
        'AfterModuleCreate',
        'AfterModuleCreateFailed',
        'AfterModuleCustom',
        'AfterModuleCustomFailed',
        'AfterModuleDeprovisionAddOnFeature',
        'AfterModuleDeprovisionAddOnFeatureFailed',
        'AfterModuleProvisionAddOnFeature',
        'AfterModuleProvisionAddOnFeatureFailed',
        'AfterModuleSuspend',
        'AfterModuleSuspendAddOnFeature',
        'AfterModuleSuspendAddOnFeatureFailed',
        'AfterModuleSuspendFailed',
        'AfterModuleTerminate',
        'AfterModuleTerminateFailed',
        'AfterModuleUnsuspend',
        'AfterModuleUnsuspendAddOnFeature',
        'AfterModuleUnsuspendAddOnFeatureFailed',
        'AfterModuleUnsuspendFailed',
        'OverrideModuleUsernameGeneration',
        'PreModuleChangePackage',
        'PreModuleChangePassword',
        'PreModuleCreate',
        'PreModuleCustom',
        'PreModuleDeprovisionAddOnFeature',
        'PreModuleProvisionAddOnFeature',
        'PreModuleRenew',
        'PreModuleSuspend',
        'PreModuleSuspendAddOnFeature',
        'PreModuleTerminate',
        'PreModuleUnsuspend',
        'PreModuleUnsuspendAddOnFeature',
        'DomainDelete',
        'DomainEdit',
        'DomainTransferCompleted',
        'DomainTransferFailed',
        'DomainValidation',
        'PreDomainRegister',
        'PreDomainTransfer',
        'PreRegistrarRegisterDomain',
        'PreRegistrarRenewDomain',
        'PreRegistrarTransferDomain',
        'TopLevelDomainAdd',
        'TopLevelDomainDelete',
        'TopLevelDomainPricingUpdate',
        'TopLevelDomainUpdate',
        'AfterRegistrarGetContactDetails',
        'AfterRegistrarGetDNS',
        'AfterRegistrarGetEPPCode',
        'AfterRegistrarGetNameservers',
        'AfterRegistrarRegister',
        'AfterRegistrarRegistration',
        'AfterRegistrarRegistrationFailed',
        'AfterRegistrarRenew',
        'AfterRegistrarRenewal',
        'AfterRegistrarRenewalFailed',
        'AfterRegistrarRequestDelete',
        'AfterRegistrarSaveContactDetails',
        'AfterRegistrarSaveDNS',
        'AfterRegistrarSaveNameservers',
        'AfterRegistrarTransfer',
        'AfterRegistrarTransferFailed',
        'PreRegistrarGetContactDetails',
        'PreRegistrarGetDNS',
        'PreRegistrarGetEPPCode',
        'PreRegistrarGetNameservers',
        'PreRegistrarRequestDelete',
        'PreRegistrarSaveContactDetails',
        'PreRegistrarSaveDNS',
        'PreRegistrarSaveNameservers',
        'AddonActivated',
        'AddonActivation',
        'AddonAdd',
        'AddonCancelled',
        'AddonConfig',
        'AddonConfigSave',
        'AddonDeleted',
        'AddonEdit',
        'AddonRenewal',
        'AddonSuspended',
        'AddonTerminated',
        'AddonUnsuspended',
        'AfterAddonUpgrade',
        'LicensingAddonReissue',
        'LicensingAddonVerify',
        'ProductAddonDelete',
        'AfterClientMerge',
        'ClientAdd',
        'ClientAlert',
        'ClientChangePassword',
        'ClientClose',
        'ClientDelete',
        'ClientDetailsValidation',
        'ClientEdit',
        'PreDeleteClient',
        'UserAdd',
        'UserChangePassword',
        'UserEdit',
        'UserEmailVerificationComplete',
        'ContactAdd',
        'ContactDelete',
        'ContactDetailsValidation',
        'ContactEdit',
        'AfterProductUpgrade',
        'ProductDelete',
        'ProductEdit',
        'ServerAdd',
        'ServerDelete',
        'ServerEdit',
        'AdminAreaViewTicketPage',
        'AdminAreaViewTicketPageSidebar',
        'AdminSupportTicketPagePreTickets',
        'ClientAreaPageSubmitTicket',
        'ClientAreaPageSupportTickets',
        'ClientAreaPageViewTicket',
        'SubmitTicketAnswerSuggestions',
        'TicketAddNote',
        'TicketAdminReply',
        'TicketClose',
        'TicketDelete',
        'TicketDeleteReply',
        'TicketDepartmentChange',
        'TicketFlagged',
        'TicketMerge',
        'TicketOpen',
        'TicketOpenAdmin',
        'TicketOpenValidation',
        'TicketPiping',
        'TicketPriorityChange',
        'TicketSplit',
        'TicketStatusChange',
        'TicketSubjectChange',
        'TicketUserReply',
        'TransliterateTicketText',
        'AnnouncementAdd',
        'AnnouncementEdit',
        'FileDownload',
        'NetworkIssueAdd',
        'NetworkIssueClose',
        'NetworkIssueDelete',
        'NetworkIssueEdit',
        'NetworkIssueReopen',
        'ClientLoginShare',
        'UserLogin',
        'UserLogout',
        'ClientAreaDomainDetails',
        'ClientAreaHomepage',
        'ClientAreaHomepagePanels',
        'ClientAreaNavbars',
        'ClientAreaPage',
        'ClientAreaPageAddContact',
        'ClientAreaPageAddFunds',
        'ClientAreaPageAddonModule',
        'ClientAreaPageAffiliates',
        'ClientAreaPageAnnouncements',
        'ClientAreaPageBanned',
        'ClientAreaPageBulkDomainManagement',
        'ClientAreaPageCancellation',
        'ClientAreaPageCart',
        'ClientAreaPageChangePassword',
        'ClientAreaPageConfigureSSL',
        'ClientAreaPageContact',
        'ClientAreaPageContacts',
        'ClientAreaPageCreditCard',
        'ClientAreaPageCreditCardCheckout',
        'ClientAreaPageDomainAddons',
        'ClientAreaPageDomainContacts',
        'ClientAreaPageDomainDNSManagement',
        'ClientAreaPageDomainDetails',
        'ClientAreaPageDomainEPPCode',
        'ClientAreaPageDomainRegisterNameservers',
        'ClientAreaPageDomains',
        'ClientAreaPageDownloads',
        'ClientAreaPageEmails',
        'ClientAreaPageHome',
        'ClientAreaPageInvoices',
        'ClientAreaPageKnowledgebase',
        'ClientAreaPageLogin',
        'ClientAreaPageLogout',
        'ClientAreaPageMassPay',
        'ClientAreaPageNetworkIssues',
        'ClientAreaPagePasswordReset',
        'ClientAreaPageProductDetails',
        'ClientAreaPageProductsServices',
        'ClientAreaPageProfile',
        'ClientAreaPageQuotes',
        'ClientAreaPageRegister',
        'ClientAreaPageSecurity',
        'ClientAreaPageServerStatus',
        'ClientAreaPageUnsubscribe',
        'ClientAreaPageUpgrade',
        'ClientAreaPageViewEmail',
        'ClientAreaPageViewInvoice',
        'ClientAreaPageViewQuote',
        'ClientAreaPaymentMethods',
        'ClientAreaPrimaryNavbar',
        'ClientAreaPrimarySidebar',
        'ClientAreaProductDetails',
        'ClientAreaProductDetailsPreModuleTemplate',
        'ClientAreaRegister',
        'ClientAreaSecondaryNavbar',
        'ClientAreaSecondarySidebar',
        'ClientAreaSidebars',
        'AdminAreaClientSummaryActionLinks',
        'AdminAreaClientSummaryPage',
        'AdminAreaPage',
        'AdminAreaViewQuotePage',
        'AdminClientDomainsTabFields',
        'AdminClientDomainsTabFieldsSave',
        'AdminClientFileUpload',
        'AdminClientProfileTabFields',
        'AdminClientProfileTabFieldsSave',
        'AdminClientServicesTabFields',
        'AdminClientServicesTabFieldsSave',
        'AdminHomepage',
        'AdminLogin',
        'AdminLogout',
        'AdminPredefinedAddons',
        'AdminProductConfigFields',
        'AdminProductConfigFieldsSave',
        'AdminServiceEdit',
        'AuthAdmin',
        'AuthAdminApi',
        'InvoiceCreationAdminArea',
        'PreAdminServiceEdit',
        'ViewOrderDetailsPage',
        'AdminAreaFooterOutput',
        'AdminAreaHeadOutput',
        'AdminAreaHeaderOutput',
        'AdminInvoicesControlsOutput',
        'ClientAreaDomainDetailsOutput',
        'ClientAreaFooterOutput',
        'ClientAreaHeadOutput',
        'ClientAreaHeaderOutput',
        'ClientAreaProductDetailsOutput',
        'FormatDateForClientAreaOutput',
        'FormatDateTimeForClientAreaOutput',
        'ReportViewPostOutput',
        'ReportViewPreOutput',
        'ShoppingCartCheckoutOutput',
        'ShoppingCartConfigureProductAddonsOutput',
        'ShoppingCartViewCartOutput',
        'AfterCronJob',
        'DailyCronJob',
        'DailyCronJobPreEmail',
        'PopEmailCollectionCronCompleted',
        'PostAutomationTask',
        'PreAutomationTask',
        'PreCronJob',
        'AffiliateActivation',
        'AffiliateClickthru',
        'AffiliateCommission',
        'AffiliateWithdrawalRequest',
        'AfterConfigOptionsUpgrade',
        'CCUpdate',
        'CalcAffiliateCommission',
        'CustomFieldLoad',
        'CustomFieldSave',
        'EmailPreLog',
        'EmailPreSend',
        'EmailTplMergeFields',
        'FetchCurrencyExchangeRates',
        'IntelligentSearch',
        'LinkTracker',
        'LogActivity',
        'NotificationPreSend',
        'PayMethodMigration',
        'PreEmailSendReduceRecipients',
        'PreUpgradeCheckout',
        'PremiumPriceOverride',
        'PremiumPriceRecalculationOverride'
    ];

    /**
     * Hook name
     *
     * @var string
     */
    protected string $hookname;

    /**
     * Hook priority
     *
     * @var int
     */
    protected int $priority = 1;

    /**
     * Class constructor
     */
    public function __construct()
    {
        if (!in_array($this->hookname, self::$availableHooks)) {
            throw new Exception("Invalid hook name: {$this->hookname}");
        }
        add_hook($this->hookname, $this->priority, [$this, 'hookCallback']);
    }

    /**
     * Hook callback
     *
     * @param  array      $params Hook parameters
     * @return mixed|null         Hook return value
     */
    abstract public function hookCallback(array $vars): mixed;
}
